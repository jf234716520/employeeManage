!
function(a) {
    // objArr:[{text:'2月',value:'2016-02'}]
    a.fn.wylTimeLine = function(b,objArr,callback) {
        // 生成原点
        for (var i = 0; i< objArr.length; i++) {
            var adiv = a("<div class='item'></div>");
            a(".lines").eq(0).after(adiv);
        }
       
        var c = {
            item: ".item",
            top: 20,
            pointWidth: 22,
            cornerWidth: 22,
            scroll: !0
        },
        d = a.extend(c, b),
        e = a(this).eq(0);
        e.css("position", "relative");
        
        var f = e.find(d.item);
        f.css({
            position: "absolute",
            margin: 0,
            overflow: "visible",
            transition: "none"
        });
        var g = [],
        //时间轴的宽度
        h = e.width(),
        // item的高，宽、与顶部距离
        i = f.eq(0).outerHeight(),
        j = f.eq(0).outerWidth(),
        l = d.top,
        m = h - 2 * j,
        n = (h - d.pointWidth) / 2;
        a(".cornerL").css({"margin-left":h+20});
        if (a(".lines").length <2) {
           // a(e).append('<div class="lines"></div>');
        }
        
        var o = a(e).find(".lines").outerWidth() || 0,
        p = (h - o) / 2;
        e.find(".lines")/*.css("left", p)*/.animate({
            width: "100%"
        },
        {
            queue: !1,
            duration: 2e3
        }),
        this.getminIndex = function(a, b) {
            for (k in a) if (a[k] == b) return k
        };
        for (var q = 0; q < f.length; q++) {
            var r = f.eq(q).outerHeight();
            2 > q ? (g[q] = r, f.eq(q).css({
                top: '0',
                left: q * j
            })) : (i = Math.min.apply(Math, g), minKey = this.getminIndex(g, i), g[minKey] += r + l, f.eq(q).css({
                top: '0',
                left: minKey * j
            })),
            maxH = Math.max.apply(Math, g),
            maxKey = this.getminIndex(g, maxH),
            e.css("height", 20);//g[maxKey] + margin-left
        }
        if (a.each(f,
        function(b, c) {
             n = (parseInt(d.pointWidth,10)+35)*b-5;
            var e = a(c).css("left");
            a(c).append('<span class="point" title="'+objArr[b].value+'"></span>');
            var f = "-" + d.cornerWidth + "px";
            "0px" == e || 0 == e ? (a(c).find(".point").css({
                top: "-42px",
                left: n
            }), a(c).find("span.top").css("left", 0), 
            a(c).append('<span style="font-size:12px;position:absolute;width:60px;margin-top:-15px;margin-left:'+n+'px">'+objArr[b].text+'</span>')
            ) : (a(c).css("margin-left", m), a(c).find("span.top").css("right", 0), a(c).find(".point").css({
                //top: "-40px",
                right: n
            })/*, 
            a(c).append('<span class="cornerR" style="left:' + f + ';top:40px"></span>')*/
            );
            if (callback.itemCallback.preClickDate == objArr[b].value) {
            	a("span[title='"+objArr[b].value+"']").addClass("pointHover");
            }
        }), d.scroll) {
            var s = a("body").height();
            f.find(".point").bind("click",
                /*function() {
                var c = a(this).offset().top,
                d = 0;
                d = c >= 460 ? 0 : s,
                a("html,body").animate({
                    scrollTop: d
                },
                660)
                
                
            }*/callback.itemCallback);
            a(".cornerL").unbind();
            a(".cornerR").unbind();
            
            //右箭头
            a(".cornerL").bind('click',function(eve) {
            	var item0 = a(".item").eq(0);
                var startDateStr = item0.find(".point").attr("title");
                var itemLast = a(".item").eq(a(".item").length - 1);
                var endDateStr = itemLast.find(".point").attr("title");
                if (callback.maxDate != endDateStr) {
	                //移除当前所有时间点
	                a("div").remove(".item");
	               // 重新生成时间轴时间
	                 var len = objArr.length;
	                 objArr = function(startDateStr,len) {
	                     var arr = [];
	                     var year = startDateStr.split("-")[0];
	                     var month = startDateStr.split("-")[1];
	                     var date = new Date(year,parseInt(month,10) - 1,01);
	                     for(var arrIndex = 0; arrIndex < len ; arrIndex++) {
	                         var tempDate = new Date(date.getFullYear(),date.getMonth() + arrIndex + 1, 01);
	                         var mm = tempDate.getMonth() + 1;
	                         arr[arrIndex] = {text:mm+'月',value:tempDate.getFullYear() + "-"+((mm)<10?"0"+(mm):mm)};
	                     }
	                     return arr;
	                 }(startDateStr,len);
	                 callback.rightCallback(a,eve,objArr);
                }
            });
            //左箭头
            a(".cornerR").bind('click',function(eve) {
                var itemLast = a(".item").eq(a(".item").length - 1);
                var endDate = itemLast.find(".point").attr("title");
                //移除当前所有时间点
                a("div").remove(".item");
                // 重新生成时间轴时间
                 var len = objArr.length;
                 objArr = function(endDateStr,len) {
                     var arr = [];
                     var year = endDateStr.split("-")[0];
                     var month = endDateStr.split("-")[1];
                     var date = new Date(year,parseInt(month,10) - 1,01);
                     for(var arrIndex = len; arrIndex > 0 ; arrIndex--) {
                         var tempDate = new Date(date.getFullYear(),date.getMonth() - arrIndex, 01);
                         var mm = tempDate.getMonth() + 1;
                         arr[len - arrIndex] = {text:mm+'月',value:tempDate.getFullYear() + "-"+((mm)<10?"0"+(mm):mm)};
                     }
                     return arr;
                 }(endDate,len);
                callback.leftCallback(a,eve,objArr);
            
            });
        }
    }
} (jQuery);